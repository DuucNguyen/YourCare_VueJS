import{A as V}from"./ApiRole-BOBO8ISd.js";import{_ as N,r as A,j as y,z as B,c as f,b as n,a as i,w as c,d as r,f as p,g as u,F as L,e as C,t as x,h as $,C as b}from"./index-ruO88dao.js";const F={class:"main"},j={class:"crud-layout-header"},q={class:"main_body"},E={class:"claim_container"},I={class:"claim_item"},X={class:"claim_header"},z={class:"claim_body"},H={__name:"create",setup(M){const k=A(),m=y({roleName:"",roleClaims:[]}),w={roleName:[{required:!0,message:"Vui lòng điền tên vai trò",trigger:"change"}],roleClaims:[{type:"array",required:!0,message:"Chọn ít nhất một quyền."}]},a=y({indeterminate:!1,isCheckedAll:!1,checkList_DoctorProfile:[],checkList_PatientProfile:[],checkList_User:[],checkList_Role:[],checkList_Specialty:[],checkList_TimeSlot:[],checkList_Timetable:[],checkList_All:[]}),o=[{name:"DoctorProfile",actions:["Create","View","Update","Delete"]},{name:"PatientProfile",actions:["Create","View","Update","Delete"]},{name:"User",actions:["Create","View","Update","Delete"]},{name:"Role",actions:["Create","View","Update","Delete"]},{name:"Specialty",actions:["Create","View","Update","Delete"]},{name:"TimeSlot",actions:["Create","View","Update","Delete"]},{name:"Timetable",actions:["Create","View","Update","Delete"]}],P=t=>{Object.assign(a,{checkList_All:t.target.checked?o:[],checkList_DoctorProfile:t.target.checked?o.find(e=>e.name==="DoctorProfile").actions:[],checkList_PatientProfile:t.target.checked?o.find(e=>e.name==="PatientProfile").actions:[],checkList_User:t.target.checked?o.find(e=>e.name==="User").actions:[],checkList_Role:t.target.checked?o.find(e=>e.name==="Role").actions:[],checkList_Specialty:t.target.checked?o.find(e=>e.name==="Specialty").actions:[],checkList_TimeSlot:t.target.checked?o.find(e=>e.name==="TimeSlot").actions:[],checkList_Timetable:t.target.checked?o.find(e=>e.name==="Timetable").actions:[]})};B(()=>[...a.checkList_DoctorProfile,...a.checkList_PatientProfile,...a.checkList_Role,...a.checkList_User,...a.checkList_Specialty,...a.checkList_TimeSlot,...a.checkList_Timetable],t=>{var e=o.reduce((s,_)=>s+_.actions.length,0),d=t.length;a.isCheckedAll=d===e,a.indeterminate=d&&d<e,m.roleClaims=o.flatMap(s=>a[`checkList_${s.name}`].map(_=>`${m.roleName}_${s.name}_${_}`))});const g=t=>`checkList_${t}`,U=()=>{k.value.validate().then(async()=>{var t=new FormData;t.append("RoleName",m.roleName),m.roleClaims.forEach((d,s)=>{t.append(`RoleClaims[${s}]`,d)});var e=await V.CreateListRoleClaim(t);e.data.isSucceeded?b.success(e.data.message):b.error(e.data.message)}).catch(t=>{console.log(t)})};return(t,e)=>{const d=r("RouterLink"),s=r("a-input"),_=r("a-form-item"),v=r("a-checkbox"),D=r("a-checkbox-group"),R=r("a-button"),T=r("a-popconfirm"),S=r("a-form");return p(),f("div",F,[n("div",j,[e[3]||(e[3]=n("h2",{class:"crud-layout-header-title"},"Create Role",-1)),i(d,{class:"crud-layout-header-button",to:{name:"Admin_Role_View"}},{default:c(()=>e[2]||(e[2]=[u(" Index ")])),_:1})]),n("div",q,[i(S,{layout:"vertical",ref_key:"formRef",ref:k,model:m,rules:w},{default:c(()=>[i(_,{name:"roleName",label:"Tên vai trò mới"},{default:c(()=>[i(s,{value:m.roleName,"onUpdate:value":e[0]||(e[0]=l=>m.roleName=l),placeholder:"Tên vai trò"},null,8,["value"])]),_:1}),i(v,{class:"checkbox_all",checked:a.isCheckedAll,"onUpdate:checked":e[1]||(e[1]=l=>a.isCheckedAll=l),indeterminate:a.indeterminate,onChange:P},{default:c(()=>e[4]||(e[4]=[u("Check all")])),_:1},8,["checked","indeterminate"]),i(_,{name:"roleClaims",label:"Quyền truy cập"},{default:c(()=>[n("div",E,[(p(),f(L,null,C(o,l=>n("div",I,[n("div",X,[n("span",null,x(l.name),1)]),n("div",z,[i(D,{class:"claim_group",value:a[g(l.name)],"onUpdate:value":h=>a[g(l.name)]=h},{default:c(()=>[(p(!0),f(L,null,C(l.actions,h=>(p(),$(v,{value:h},{default:c(()=>[u(x(h),1)]),_:2},1032,["value"]))),256))]),_:2},1032,["value","onUpdate:value"])])])),64))])]),_:1}),i(_,{class:"w-100 d-flex justify-content-end"},{default:c(()=>[i(T,{placement:"bottom","ok-text":"Xác nhận",okButtonProps:{type:"primary",style:{height:"30px",width:"150px"}},cancelButtonProps:{style:{height:"30px",width:"80px"}},"cancel-text":"Hủy",onConfirm:U},{title:c(()=>e[5]||(e[5]=[n("span",{class:"fs-6 text-primary"},"Xác nhận tạo mới",-1),n("br",null,null,-1),n("span",{class:"text-danger"},"Vui lòng kiểm tra lại thông tin phía trên.",-1)])),default:c(()=>[i(R,{type:"primary",style:{height:"40px","font-weight":"500"},class:"w-100 fs-6"},{default:c(()=>e[6]||(e[6]=[u(" Tạo mới ")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])])}}},G=N(H,[["__scopeId","data-v-8e1313d7"]]);export{G as default};
