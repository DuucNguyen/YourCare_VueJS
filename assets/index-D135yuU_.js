import{a as e,I as J,_ as ut,u as dt,r as w,y as g,j as pt,o as ct,c as D,b as a,n as z,T as q,F as G,e as R,w as n,d as y,m as mt,f as h,O as U,t as d,q as _,h as j,G as ft,g as x,M as F,E as X,C as T}from"./index-SWlYOb7A.js";import{A as H}from"./ApiAppointment-DT-DO1hC.js";import{A as _t}from"./ApiDoctorProfile-BG9r5GYk.js";import{D as vt}from"./DoctorSideBar-DeFA-XQK.js";import{A as C}from"./AppointmentStatus-C_9gBi1V.js";import{u as ht}from"./route-store-DsiDn0_s.js";/* empty css                                                                      */var gt={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"};function K(c){for(var r=1;r<arguments.length;r++){var p=arguments[r]!=null?Object(arguments[r]):{},v=Object.keys(p);typeof Object.getOwnPropertySymbols=="function"&&(v=v.concat(Object.getOwnPropertySymbols(p).filter(function(u){return Object.getOwnPropertyDescriptor(p,u).enumerable}))),v.forEach(function(u){yt(c,u,p[u])})}return c}function yt(c,r,p){return r in c?Object.defineProperty(c,r,{value:p,enumerable:!0,configurable:!0,writable:!0}):c[r]=p,c}var Y=function(r,p){var v=K({},r,p.attrs);return e(J,K({},v,{icon:gt}),null)};Y.displayName="InboxOutlined";Y.inheritAttrs=!1;var bt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 780H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM505.7 669a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V176c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8z"}}]},name:"vertical-align-bottom",theme:"outlined"};function W(c){for(var r=1;r<arguments.length;r++){var p=arguments[r]!=null?Object(arguments[r]):{},v=Object.keys(p);typeof Object.getOwnPropertySymbols=="function"&&(v=v.concat(Object.getOwnPropertySymbols(p).filter(function(u){return Object.getOwnPropertyDescriptor(p,u).enumerable}))),v.forEach(function(u){xt(c,u,p[u])})}return c}function xt(c,r,p){return r in c?Object.defineProperty(c,r,{value:p,enumerable:!0,configurable:!0,writable:!0}):c[r]=p,c}var E=function(r,p){var v=W({},r,p.attrs);return e(J,W({},v,{icon:bt}),null)};E.displayName="VerticalAlignBottomOutlined";E.inheritAttrs=!1;const kt={class:"doctor_dashboard_body"},wt={class:"doctor_dashboard_section"},Dt={class:"doctor_dashboard_body"},Ot={class:"col-md-4 doctor_appointment_list"},Tt={class:"appointment_container"},Ct=["onClick"],Nt={style:{"font-weight":"500","font-size":"17px"}},St={style:{color:"#1975dc","font-weight":"500"}},Ht={style:{"font-weight":"500","font-size":"20px",color:"#22c55e"}},At={class:"h-75 mt-5 d-flex align-items-center justify-content-center"},Mt={class:"col-md-8"},Lt={key:0},jt={id:"shrinkable_appointment_detail"},Yt={class:"fs-5 d-flex align-items-center"},Et=["src"],Pt={class:"ms-2",style:{"font-weight":"500","font-size":"18px"}},It={style:{color:"#1975dc","font-weight":"500"}},Bt={class:"ant-upload-drag-icon d-flex justify-content-center"},Vt={class:"d-flex align-items-center"},zt={key:1,class:"h-100 d-flex align-items-center justify-content-center"},qt={__name:"index",setup(c){const r=mt(),p=dt(),v=ht(),u=w(v.data),A=w({}),P=w({}),S=w([]),s=w(),Q=w(g()),I=w(),f=pt({id:u.value.id??"",doctorDiagnosis:"",doctorNote:"",files:[]}),Z={doctorDiagnosis:[{required:!0,message:"Không được bỏ trống mục này",trigger:"change"}],doctorNote:[{required:!0,message:"Không được bỏ trống mục này",trigger:"change"}],files:[{type:"array",max:5,message:"Tối đa 5 tệp tin"}]},tt=async()=>{if(A.value=await p.getUserInfo(),A.value){var o=await _t.GetByUserID(A.value.id);P.value=o.data.data}},et=async()=>{var o=await H.GetDoctorAppointmentByDate(P.value,g(Q.value).format("MM/DD/YYYY"));o.data.isSucceeded&&(S.value=o.data.data)},M=async o=>{u.value=o,f.id=u.value.id,f.files=[];var t=await H.GetDetailById(u.value.id);t.data.isSucceeded&&(s.value=t.data.data,f.doctorDiagnosis=s.value.doctorDiagnosis,f.doctorNote=s.value.doctorNote)},nt=o=>{var t=o.file.status;t==="done"?T.success(`${o.file.name} file uploaded successfully.`):t==="error"&&T.error(`${o.file.name} file upload failed.`)},at=o=>{var t=o.currentTarget.classList;o.currentTarget.classList.toggle("up"),t.contains("up")?o.currentTarget.innerHTML="Thu gọn <i class='bx bx-chevron-up fs-4'></i>":o.currentTarget.innerHTML="Chi tiết <i class='bx bx-chevron-down fs-4'></i>",$("#shrinkable_appointment_detail").slideToggle()};ct(async()=>{await tt(),await et(),u.value.id&&await M(u.value)});const B=()=>{I.value.validate().then(()=>{lt()}).catch(o=>{console.log(o)})},lt=()=>{F.confirm({title:"Hoàn thành lịch khám ?",icon:e(X),content:"Xác nhận hoàn thành lịch khám cho bệnh nhân: "+s.value.patientName,okText:"Xác nhận",cancelText:"Hủy",async onOk(){try{var o=new FormData;o.append("id",f.id),o.append("doctorDiagnosis",f.doctorDiagnosis),o.append("doctorNote",f.doctorNote),f.files.length>0&&f.files.forEach(l=>{o.append("files",l.originFileObj||l)});var t=await H.CompleteAppointment(o);t.data.isSucceeded?(T.success("Hoàn thành lịch khám"),M(u.value)):T.error("Lỗi, vui lòng thử lại")}catch(l){console.log(l)}}})},st=()=>{F.confirm({title:"Xác nhận đặt lịch tái khám",icon:e(X),content:"Xác nhận đi tới trang đặt lịch tái khám cho bệnh nhân: "+u.value.patientName,okText:"Xác nhận",cancelText:"Hủy",onOk(){r.push({name:"Doctor_Appointment_Create",params:{id:u.value.id}})},onCancel(){}})},ot=async o=>{try{const t=await H.DownloadFile(o.split("\\")[1]);if(!t||!t.data)throw new Error("Invalid response");const l=new Blob([t.data],{type:t.headers["content-type"]});let i=o.split("/").pop();const N=t.headers["content-disposition"];if(N){const O=N.match(/filename="?(.+?)"?$/);O&&(i=O[1])}const b=window.URL.createObjectURL(l),k=document.createElement("a");k.href=b,k.setAttribute("download",i),document.body.appendChild(k),k.click(),document.body.removeChild(k),window.URL.revokeObjectURL(b)}catch(t){console.error("Download file error:",t),T.error("Download file error."),T.error("Lỗi, tải file thất bại")}};return(o,t)=>{const l=y("a-col"),i=y("a-row"),N=y("a-empty"),b=y("a-button"),k=y("a-qrcode"),O=y("a-textarea"),L=y("a-form-item"),it=y("a-upload-dragger"),rt=y("a-form");return h(),D("div",kt,[e(vt,{"active-item":"appointment"}),a("div",wt,[a("div",Dt,[a("div",Ot,[t[8]||(t[8]=a("div",{class:"doctor_dashboard_title"},[a("h3",{class:"mb-0 ms-3 mt-1"},"Lịch khám hôm nay")],-1)),z(a("div",Tt,[a("div",null,[(h(!0),D(G,null,R(S.value,m=>(h(),D("div",{class:U("appointment_item "+(u.value.id==m.id?"appointment_item_chosen":"")),onClick:V=>M(m)},[e(i,null,{default:n(()=>[e(l,{span:24},{default:n(()=>[a("span",Nt,d(m.doctorName),1)]),_:2},1024)]),_:2},1024),e(i,null,{default:n(()=>[e(l,{span:20},{default:n(()=>[a("span",null,d(_(g)(m.timetableStartTime,"HH:mm:ss").format("HH:mm"))+" - ",1),a("span",St,d(_(g)(m.timetableDate).format("DD-MM-YYYY")),1),t[3]||(t[3]=a("br",null,null,-1)),a("span",null,d(m.patientName),1),t[4]||(t[4]=a("br",null,null,-1)),a("span",{class:U((m.status===_(C).COMPLETED?"text-primary":"text-secondary")+" ms-3"),style:{"font-size":"13px"}},d(m.status),3)]),_:2},1024),e(l,{span:4,class:"text-center"},{default:n(()=>[t[5]||(t[5]=a("span",{style:{"font-size":"12px"}},"STT",-1)),t[6]||(t[6]=a("br",null,null,-1)),a("span",Ht,d(m.timeTableOrder),1)]),_:2},1024)]),_:2},1024)],10,Ct))),256))])],512),[[q,S.value.length>0]]),z(a("div",At,[e(N,{class:""},{description:n(()=>t[7]||(t[7]=[a("span",null,"Không có lịch khám trong hôm nay",-1)])),_:1})],512),[[q,S.value.length<=0]])]),a("div",Mt,[e(l,{span:23,class:"appointment_detail_container"},{default:n(()=>[s.value?(h(),D("div",Lt,[s.value.status===_(C).WAITING||s.value.status===_(C).PROCESSING?(h(),j(i,{key:0,class:"appointment_detail_buttons"},{default:n(()=>[e(b,{onClick:B,type:"primary"},{default:n(()=>t[9]||(t[9]=[x(" Xác nhận đã khám xong ")])),_:1}),e(b,{onClick:B,type:"primary"},{default:n(()=>t[10]||(t[10]=[x(" Đợi kết quả ")])),_:1}),e(b,{type:"primary",danger:""},{default:n(()=>t[11]||(t[11]=[x("Hủy")])),_:1})]),_:1})):ft("",!0),a("div",jt,[e(i,null,{default:n(()=>[e(l,{span:12,class:"text-start",style:{color:"#22c55e","font-weight":"500","font-size":"20px"}},{default:n(()=>[x(" STT: "+d(u.value.timeTableOrder),1)]),_:1}),e(l,{span:12,class:"text-secondary d-flex justify-content-end"},{default:n(()=>[a("span",Yt,[t[12]||(t[12]=a("i",{class:"bx bx-error-alt fs-4 me-1"},null,-1)),x(" "+d(u.value.status),1)])]),_:1})]),_:1}),e(i,{class:"mt-1"},{default:n(()=>[e(l,{span:24,class:"d-flex justify-content-end"},{default:n(()=>[e(b,{type:"primary",class:"d-flex align-items-center",onClick:st},{default:n(()=>t[13]||(t[13]=[x(" Hẹn tái khám "),a("i",{class:"bx bx-right-arrow-alt fs-5"},null,-1)])),_:1})]),_:1})]),_:1}),e(i,{class:"mt-1"},{default:n(()=>[e(l,{span:12},{default:n(()=>[a("img",{style:{width:"75px",height:"100%","object-fit":"contain"},src:s.value.doctorImage},null,8,Et),a("span",Pt,d(s.value.doctorName),1)]),_:1}),e(l,{span:12,class:"d-flex justify-content-end"},{default:n(()=>[e(k,{size:100,value:s.value.appointmentCode+" / "+s.value.doctorName+" / "+s.value.patientName+" / "+_(g)(s.value.timetableDate).format("DD/MM/YYYY")+" / STT: "+s.value.timeTableOrder+" / "+s.value.timetableStartTime+"-"+s.value.timetableEndTime},null,8,["value"])]),_:1})]),_:1}),e(i,null,{default:n(()=>[e(l,{span:24,class:"appointment_detail_title"},{default:n(()=>t[14]||(t[14]=[a("span",null," Thông tin lịch khám ",-1)])),_:1})]),_:1}),a("div",null,[e(i,{class:"appointment_detail_item"},{default:n(()=>[e(l,{span:12},{default:n(()=>t[15]||(t[15]=[a("span",null,"Mã phiếu khám",-1)])),_:1}),e(l,{span:12},{default:n(()=>[a("span",It,d(s.value.appointmentCode),1)]),_:1})]),_:1}),e(i,{class:"appointment_detail_item"},{default:n(()=>[e(l,{span:12},{default:n(()=>t[16]||(t[16]=[a("span",null," Ngày khám ",-1)])),_:1}),e(l,{span:12},{default:n(()=>[a("span",null,d(_(g)(s.value.timetableDate).format("DD/MM/YYYY")),1)]),_:1})]),_:1}),e(i,{class:"appointment_detail_item"},{default:n(()=>[e(l,{span:12},{default:n(()=>t[17]||(t[17]=[a("span",null,"Ca khám",-1)])),_:1}),e(l,{span:12},{default:n(()=>[a("span",null,d(_(g)(s.value.timetableStartTime,"HH:mm:ss").format("HH:mm"))+" - "+d(_(g)(s.value.timetableEndTime,"HH:mm:ss").format("HH:mm")),1)]),_:1})]),_:1})]),e(i,null,{default:n(()=>[e(l,{span:24,class:"appointment_detail_title"},{default:n(()=>t[18]||(t[18]=[a("span",null," Thông tin bệnh nhân ",-1)])),_:1})]),_:1}),a("div",null,[e(i,{class:"appointment_detail_item"},{default:n(()=>[e(l,{span:12},{default:n(()=>t[19]||(t[19]=[a("span",null," Số thứ tự trong ca ",-1)])),_:1}),e(l,{span:12},{default:n(()=>[a("span",null,d(s.value.timeTableOrder),1)]),_:1})]),_:1}),e(i,{class:"appointment_detail_item"},{default:n(()=>[e(l,{span:12},{default:n(()=>t[20]||(t[20]=[a("span",null," Họ và tên ",-1)])),_:1}),e(l,{span:12},{default:n(()=>[a("span",null,d(s.value.patientName),1)]),_:1})]),_:1}),e(i,{class:"appointment_detail_item"},{default:n(()=>[e(l,{span:12},{default:n(()=>t[21]||(t[21]=[a("span",null," Ngày sinh ",-1)])),_:1}),e(l,{span:12},{default:n(()=>[a("span",null,d(s.value.patientDob!=null?_(g)(s.value.patientDob).format("DD/MM/YYYY"):"Chưa cập nhật"),1)]),_:1})]),_:1}),e(i,{class:"appointment_detail_item"},{default:n(()=>[e(l,{span:12},{default:n(()=>t[22]||(t[22]=[a("span",null," Số điện thoại ",-1)])),_:1}),e(l,{span:12},{default:n(()=>[a("span",null,d(s.value.patientPhoneNumber!=null?s.value.patientPhoneNumber:"Chưa cập nhật"),1)]),_:1})]),_:1}),e(i,{class:"appointment_detail_item"},{default:n(()=>[e(l,{span:12},{default:n(()=>t[23]||(t[23]=[a("span",null," Giới tính ",-1)])),_:1}),e(l,{span:12},{default:n(()=>[a("span",null,d(s.value.patientGender==!0?"Nam":"Nữ"),1)]),_:1})]),_:1}),e(i,{class:"appointment_detail_item"},{default:n(()=>[e(l,{span:12},{default:n(()=>t[24]||(t[24]=[a("span",null," Địa chỉ ",-1)])),_:1}),e(l,{span:12},{default:n(()=>[a("span",null,d(s.value.patientAddress!=null&&s.value.patientAddress!=""?s.value.patientAddress:"Chưa cập nhật"),1)]),_:1})]),_:1}),e(i,{class:"appointment_detail_item"},{default:n(()=>[e(l,{span:12},{default:n(()=>t[25]||(t[25]=[a("span",null,"Lời nhắn",-1)])),_:1}),e(l,{span:12},{default:n(()=>[e(O,{value:s.value.patientNote,placeholder:"Không có lời nhắn",readonly:""},{default:n(()=>[x(d(s.value.patientNote),1)]),_:1},8,["value"])]),_:1})]),_:1})])]),a("div",{style:{cursor:"pointer"},class:"text-primary fs-6 d-flex align-items-center justify-content-center m-2 mt-4 up",onClick:at},t[26]||(t[26]=[x(" Thu gọn "),a("i",{class:"bx bx-chevron-up fs-4"},null,-1)])),e(i,null,{default:n(()=>[e(l,{span:24,class:"appointment_detail_title"},{default:n(()=>t[27]||(t[27]=[a("span",null," Kết quả ",-1)])),_:1})]),_:1}),a("div",null,[e(rt,{ref_key:"formRef",ref:I,model:f,rules:Z},{default:n(()=>[e(L,{name:"doctorDiagnosis"},{default:n(()=>[e(i,{class:"appointment_detail_item"},{default:n(()=>[e(l,{span:24},{default:n(()=>t[28]||(t[28]=[a("span",null,"Chuẩn đoán",-1)])),_:1}),e(l,{span:24},{default:n(()=>[e(O,{readonly:s.value.status===_(C).COMPLETED,value:f.doctorDiagnosis,"onUpdate:value":t[0]||(t[0]=m=>f.doctorDiagnosis=m),placeholder:"Chuẩn đoán, kết luận của bác sĩ,..."},null,8,["readonly","value"])]),_:1})]),_:1})]),_:1}),e(L,{name:"doctorNote"},{default:n(()=>[e(i,{class:"appointment_detail_item"},{default:n(()=>[e(l,{span:24},{default:n(()=>t[29]||(t[29]=[a("span",null,"Ghi chú của Bác sĩ",-1)])),_:1}),e(l,{span:24},{default:n(()=>[e(O,{readonly:s.value.status===_(C).COMPLETED,value:f.doctorNote,"onUpdate:value":t[1]||(t[1]=m=>f.doctorNote=m),placeholder:"VD: Lịch tái khám, thuốc, lời khuyên, ..."},null,8,["readonly","value"])]),_:1})]),_:1})]),_:1}),e(L,{name:"files"},{default:n(()=>[e(i,{class:"appointment_detail_item"},{default:n(()=>[e(l,{span:24},{default:n(()=>t[30]||(t[30]=[a("span",null,"Tệp đính kèm",-1)])),_:1}),!s.value.files||s.value.status!==_(C).COMPLETED?(h(),j(l,{key:0,span:24},{default:n(()=>[e(it,{class:"p-1 w-100",style:{"max-height":"200px"},"list-type":"picture",fileList:f.files,"onUpdate:fileList":t[2]||(t[2]=m=>f.files=m),multiple:!0,action:"https://run.mocky.io/v3/5496d046-c459-4dec-8b1c-09edcdd8f880",onChange:nt},{default:n(()=>[a("p",Bt,[e(_(Y))]),t[31]||(t[31]=a("p",{class:"ant-upload-text"}," Tải lên kết quả khám bệnh, bệnh án, ... ",-1)),t[32]||(t[32]=a("p",{class:"ant-upload-hint"}," Hỗ trợ tải lên nhiều file. Nghiêm cấm tải lên các tài liệu không liên quan đến quá trình khám bệnh hoặc tài liệu phòng khám ",-1))]),_:1},8,["fileList"])]),_:1})):(h(),j(l,{key:1,span:24},{default:n(()=>[(h(!0),D(G,null,R(s.value.files,(m,V)=>(h(),D("div",Vt,[a("span",null,d((V+1).toString().padStart(2,"0"))+" - "+d(m.split("\\")[1]),1),e(b,{onClick:Gt=>ot(m),type:"primary",class:"d-flex align-items-center"},{default:n(()=>[e(_(E))]),_:2},1032,["onClick"])]))),256))]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])])])):(h(),D("div",zt,[e(N,null,{description:n(()=>t[33]||(t[33]=[a("span",null,"Không có thông tin",-1)])),_:1})]))]),_:1})])])])])}}},Jt=ut(qt,[["__scopeId","data-v-5839978c"]]);export{Jt as default};
