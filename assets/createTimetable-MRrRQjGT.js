import{A as H}from"./ApiDoctorProfile-BreSfu88.js";import{A as J}from"./ApiTimeSlot-Z6zU4kp7.js";import{A as K}from"./ApiTimetable-5llWu8HF.js";import{x as N,_ as Q,y as h,r as x,k as W,j as X,z as Z,i as ee,c as g,b as t,t as c,F as O,e as w,a as d,w as u,d as k,f as _,g as v,h as D,M as te,E as se,s as ae}from"./index-BuR_787K.js";var y={exports:{}},oe=y.exports,E;function ne(){return E||(E=1,function(b,T){(function(r,l){b.exports=l()})(oe,function(){return function(r,l){l.prototype.isSameOrAfter=function(i,m){return this.isSame(i,m)||this.isAfter(i,m)}}})}(y)),y.exports}var re=ne();const ie=N(re);var S={exports:{}},le=S.exports,I;function ce(){return I||(I=1,function(b,T){(function(r,l){b.exports=l()})(le,function(){return function(r,l){l.prototype.isSameOrBefore=function(i,m){return this.isSame(i,m)||this.isBefore(i,m)}}})}(S)),S.exports}var de=ce();const ue=N(de),me={key:0,class:"d-flex justify-content-between"},fe={class:"col-md-4"},pe={class:"p-3 shadow rounded-3 d-flex flex-column align-items-center",style:{"background-color":"#fff"}},_e={class:"doctor-img"},he=["src"],ve={class:"doctor-title"},ge={class:"mb-3 d-flex flex-wrap align-items-center"},ke={class:"specialization-item-capsule"},xe={class:"d-flex flex-column"},be={class:"text-decoration-underline"},ye={class:"text-decoration-underline"},Se={class:"text-decoration-underline"},Te={class:"col-md-7",style:{"background-color":"#fff"}},Ae={class:"p-3 shadow rounded-3"},Le={class:"mb-4"},Oe={class:"d-flex flex-column"},we={class:"timeTable-dayTime-title"},Be={class:"timeTable-dayTime"},Ce={class:"timeTable-dayTime-title"},De={class:"timeTable-dayTime"},Ee={class:"timeTable-dayTime"},Ie={key:1},Ne={__name:"createTimetable",setup(b){h.extend(ie),h.extend(ue);const T=W(),r=x({}),l=T.params.id||0,i=x([]),m=x([]),A=x([]),j=h().hour(6).minute(0).second(0),R=h().hour(11).minute(59).second(59),q=h().hour(12).minute(0).second(0),F=h().hour(18).minute(59).second(59),s=X({indeterminate:!1,checkAll:!1,checkedList_morning:[],checkedList_afternoon:[],checkedList_All:[],range:[]}),M=a=>{Object.assign(s,{checkedList_All:a.target.checked?i.value.map(e=>e.id):[],checkedList_morning:a.target.checked?m.value.map(e=>e.id):[],checkedList_afternoon:a.target.checked?A.value.map(e=>e.id):[],indeterminate:a.target.checked})};Z(()=>[...s.checkedList_morning,...s.checkedList_afternoon],()=>{var a=s.checkedList_morning.length+s.checkedList_afternoon.length;s.indeterminate=a&&a<i.value.length,s.checkAll=a===i.value.length,s.checkedList_All=[...s.checkedList_morning,...s.checkedList_afternoon]});const B=a=>{const[e,n,f]=a.split(":").map(Number);return h().hour(e).minute(n).second(f)};ee(async()=>{var a=await H.GetByID(l);r.value=a.data.data;var e=await J.GetAll();i.value=e.data.data,i.value.forEach(n=>{const f=B(n.startTime),p=B(n.endTime);f.isSameOrAfter(j)&&p.isSameOrBefore(R)&&m.value.push(n),f.isSameOrAfter(q)&&p.isSameOrBefore(F)&&A.value.push(n)})});const C=x(),$={timeSlots:[{validator:()=>P(),message:"Choose at leat one item before continue.",trigger:"change"}],range:[{required:!0,message:"Input cannot be null",trigger:"change"}]},P=()=>s.checkedList_afternoon.length+s.checkedList_morning.length<=0?Promise.reject("Choose at least one item before continue."):Promise.resolve(),U=()=>{C.value.validate().then(()=>{V()}).catch(a=>{console.log("INvalidate: "+a)})},V=()=>{te.confirm({title:"Are you sure to perform this action ?",icon:d(se),content:"Schedule timetable for the doctor. ",okText:"Yes",cancelText:"No",onOk:async()=>{var a=new FormData;a.append("id",l),s.checkedList_All.forEach((p,L)=>{a.append(`timetableIDs[${L}]`,p)}),a.append("startDate",s.range[0]),a.append("endDate",s.range[1]);var e=await K.CreateRange(a),n=e.data.message,f=e.data.isSucceeded?"success":"error";z(f,"Create status",n)},onCancel:()=>{}})},z=(a,e,n)=>{ae[a]({message:e,description:n})};return(a,e)=>{const n=k("a-checkbox"),f=k("a-checkbox-group"),p=k("a-form-item"),L=k("a-range-picker"),G=k("a-button"),Y=k("a-form");return r.value?(_(),g("div",me,[t("div",fe,[t("div",pe,[t("div",_e,[t("img",{src:r.value.imageString,alt:"avatar"},null,8,he)]),t("div",ve,[t("span",null,c(r.value.doctorTitle)+". ",1),t("span",null,c(r.value.fullName),1)]),t("div",ge,[(_(!0),g(O,null,w(r.value.specialties,o=>(_(),g("label",ke,c(o.title),1))),256))]),t("div",xe,[t("div",null,[e[4]||(e[4]=t("label",{style:{width:"100px"},class:""},"Phone: ",-1)),t("span",be,c(r.value.phoneNumber),1)]),t("div",null,[e[5]||(e[5]=t("label",{style:{width:"100px"},class:""},"Email: ",-1)),t("span",ye,c(r.value.email),1)]),t("div",null,[e[6]||(e[6]=t("label",{style:{width:"100px"},class:""},"Address: ",-1)),t("span",Se,c(r.value.address),1)])])])]),t("div",Te,[t("div",Ae,[e[12]||(e[12]=t("h4",{class:"text-center"},"Doctor schedule",-1)),t("div",Le,[d(n,{class:"timeTable-dayTime-item",checked:s.checkAll,"onUpdate:checked":e[0]||(e[0]=o=>s.checkAll=o),indeterminate:s.indeterminate,onChange:M},{default:u(()=>e[7]||(e[7]=[v("Check all")])),_:1},8,["checked","indeterminate"])]),t("div",Oe,[d(Y,{model:s,ref_key:"formRef",ref:C,rules:$},{default:u(()=>[d(p,{name:"timeSlots"},{default:u(()=>[t("div",we,[e[8]||(e[8]=t("span",null,[t("i",{class:"bx bx-sun"}),v(" Morning ")],-1)),t("div",Be,[d(f,{value:s.checkedList_morning,"onUpdate:value":e[1]||(e[1]=o=>s.checkedList_morning=o)},{default:u(()=>[(_(!0),g(O,null,w(m.value,o=>(_(),D(n,{key:o.id,class:"timeTable-dayTime-item",value:o.id},{default:u(()=>[v(c(o.startTime)+" - "+c(o.endTime),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),t("div",Ce,[e[9]||(e[9]=t("span",null,[t("i",{class:"bx bxs-sun"}),v(" Afternoon ")],-1)),t("div",De,[d(f,{value:s.checkedList_afternoon,"onUpdate:value":e[2]||(e[2]=o=>s.checkedList_afternoon=o)},{default:u(()=>[(_(!0),g(O,null,w(A.value,o=>(_(),D(n,{key:o.id,class:"timeTable-dayTime-item",value:o.id},{default:u(()=>[v(c(o.startTime)+" - "+c(o.endTime),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])])]),_:1}),d(p,{style:{width:"100%"},class:"w-100 mt-5 timeTable-dayTime-title",name:"range"},{default:u(()=>[e[10]||(e[10]=t("span",null,[t("i",{class:"bx bx-calendar"}),v(" Range ")],-1)),t("div",Ee,[d(L,{style:{width:"100%"},value:s.range,"onUpdate:value":e[3]||(e[3]=o=>s.range=o)},null,8,["value"])])]),_:1}),d(p,{class:"d-flex justify-content-end"},{default:u(()=>[d(G,{onClick:U,type:"primary"},{default:u(()=>e[11]||(e[11]=[v("Save")])),_:1})]),_:1})]),_:1},8,["model"])])])])])):(_(),g("div",Ie,"Doctor not found."))}}},Me=Q(Ne,[["__scopeId","data-v-6e5aa093"]]);export{Me as default};
