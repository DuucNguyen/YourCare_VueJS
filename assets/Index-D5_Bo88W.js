import{_ as J,r as g,j as I,k as K,o as Q,l as W,c as N,b as l,a as t,w as a,q as v,R as b,F as S,e as V,d as u,A as Y,m as Z,f as y,g as i,t as _,h as ee,C as F}from"./index-mrb-czRM.js";import{A as D}from"./ApiRole-DhSe5y_7.js";const ae={class:"crud-layout-header"},te={class:"crud-layout-table"},le={class:"user_item"},se={class:"col-md-2 user_item_image"},oe=["src"],ne={class:"col-md-10 user_item_info"},re={class:"mt-3"},ie=["onClick"],ue={class:"mt-3 d-flex"},de={style:{width:"80px",height:"80px"},class:"user_item_image"},pe=["src"],me={class:"mt-1 ms-3 user_item_info"},_e={class:"fs-6"},ce={class:"mt-3 d-flex"},fe={style:{width:"80px",height:"80px"},class:"user_item_image"},ge=["src"],ve={class:"mt-1 ms-3 user_item_info"},be={class:"fs-6"},ye={__name:"Index",setup(he){const m=K(),U=Z(),R=g([]),c=g(!1),d=g({}),k=g(),h=I({roleId:""}),q={roleId:[{required:"true",message:"Chọn 1 trước khi tiếp tục"}]},s=I({pageNumber:m.params.pageNumber||1,pageSize:m.params.pageSize||10,searchValue:m.params.searchValue||"",totalRecords:0,statusFilter:!1}),z=g([]),B=async()=>{var n=await D.GetAll();n.data.isSucceeded&&(R.value=n.data.data)},x=async()=>{try{var n=await Y.GetAllByLimit(s);n.data.isSucceeded&&(z.value=n.data.data,s.pageNumber=n.data.pageNumber,s.pageSize=n.data.pageSize,s.totalRecords=n.data.totalRecords,s.statusFilter&&(s.pageNumber>n.data.totalPages&&s.totalRecords>0?(s.pageNumber=1,U.push({name:"Admin_User_View",query:{pageNumber:1,pageSize:s.pageSize,searchValue:s.searchValue}})):U.push({name:"Admin_User_View",query:{pageNumber:s.pageNumber,pageSize:s.pageSize,searchValue:s.searchValue}}),s.statusFilter=!s.statusFilter))}catch(e){console.log("GetAllUserByLimit: "+e)}},T=(n,e)=>{s.pageNumber=n,s.pageSize=e,s.statusFilter=!0,x()},$=n=>{d.value=n,c.value=!0},H=()=>{k.value.validate().then(async()=>{var n=new FormData;n.append("UserId",d.value.id),n.append("RoleId",h.roleId);var e=await D.ChangeUserRole(n);e.data.isSucceeded?(F.success(e.data.message),c.value=!1,await x()):(F.error(e.data.message),c.value=!1)}).catch(n=>{console.log(n)})};return Q(async()=>{await x(),await B()}),W(()=>{Object.keys(m.query).length===0&&(s.pageNumber=m.params.pageNumber||1,s.pageSize=m.params.pageSize||10,s.searchValue=m.params.searchValue||"",s.statusFilter=!0,x())}),(n,e)=>{const r=u("a-col"),p=u("a-row"),C=u("a-divider"),f=u("a-tooltip"),L=u("a-pagination"),M=u("a-alert"),j=u("a-tag"),G=u("a-select-option"),P=u("a-select"),E=u("a-form-item"),X=u("a-form"),A=u("a-button"),O=u("a-modal");return y(),N(S,null,[l("div",ae,[e[5]||(e[5]=l("h2",{class:"crud-layout-header-title"},"Manage User",-1)),t(v(b),{class:"crud-layout-header-button",to:{name:"Admin_User_Create"}},{default:a(()=>e[4]||(e[4]=[i("Create")])),_:1})]),l("div",te,[l("div",null,[(y(!0),N(S,null,V(z.value,o=>(y(),N("div",le,[l("div",se,[l("img",{src:o.imageString},null,8,oe)]),l("div",ne,[t(p,null,{default:a(()=>[t(r,{span:4},{default:a(()=>e[6]||(e[6]=[i("Họ và tên")])),_:1}),t(r,{span:12},{default:a(()=>[l("span",null,_(o.fullName),1)]),_:2},1024)]),_:2},1024),t(C,{class:"m-1"}),l("div",re,[t(p,null,{default:a(()=>[t(r,{span:4},{default:a(()=>e[7]||(e[7]=[i("Email")])),_:1}),t(r,{span:12},{default:a(()=>[l("span",null,_(o.email),1)]),_:2},1024)]),_:2},1024),t(p,null,{default:a(()=>[t(r,{span:4},{default:a(()=>e[8]||(e[8]=[i("SĐT")])),_:1}),t(r,{span:12},{default:a(()=>[l("span",null,_(o.phoneNumber),1)]),_:2},1024)]),_:2},1024),t(C,{class:"m-1"}),t(p,{class:"user_btn_container"},{default:a(()=>[t(r,{span:4},{default:a(()=>[t(f,{placement:"top"},{title:a(()=>e[9]||(e[9]=[l("span",null,"Change role",-1)])),default:a(()=>[l("a",{class:"user_btn",onClick:w=>$(o)},e[10]||(e[10]=[l("i",{style:{color:"coral"},class:"bx bx-git-compare"},null,-1),i("Change role ")]),8,ie)]),_:2},1024)]),_:2},1024),t(r,{span:4},{default:a(()=>[t(f,{placement:"top"},{title:a(()=>e[11]||(e[11]=[l("span",null,"Details",-1)])),default:a(()=>[t(v(b),{class:"user_btn",to:{name:"Admin_User_Detail",params:{id:o.id}}},{default:a(()=>e[12]||(e[12]=[l("i",{style:{color:"blueviolet"},class:"bx bxs-user-detail"},null,-1),i(" Detail ")])),_:2},1032,["to"])]),_:2},1024)]),_:2},1024),t(r,{span:4},{default:a(()=>[t(f,{placement:"top"},{title:a(()=>e[13]||(e[13]=[l("span",null,"Create doctor profile",-1)])),default:a(()=>[t(v(b),{class:"user_btn",to:{name:"Admin_DoctorProfile_Create",params:{id:o.id}}},{default:a(()=>e[14]||(e[14]=[l("i",{style:{color:"forestgreen"},class:"bx bxs-user-badge"},null,-1),i("Create doctor")])),_:2},1032,["to"])]),_:2},1024)]),_:2},1024),t(r,{span:4},{default:a(()=>[t(f,{placement:"top"},{title:a(()=>e[15]||(e[15]=[l("span",null,"Update",-1)])),default:a(()=>[t(v(b),{class:"user_btn",to:{name:"Admin_User_Update",params:{id:o.id}}},{default:a(()=>e[16]||(e[16]=[l("i",{style:{color:"royalblue"},class:"bx bxs-edit"},null,-1),i("Update")])),_:2},1032,["to"])]),_:2},1024)]),_:2},1024),t(r,{span:4},{default:a(()=>[t(f,{placement:"top"},{title:a(()=>e[17]||(e[17]=[l("span",null,"Deactivate",-1)])),default:a(()=>[t(v(b),{class:"user_btn",to:{name:"Admin_User_Update",params:{id:o.id}}},{default:a(()=>e[18]||(e[18]=[l("i",{style:{color:"brown"},class:"bx bxs-trash"},null,-1),i(" Update")])),_:2},1032,["to"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])])]))),256))]),t(L,{onChange:T,current:s.pageNumber,"onUpdate:current":e[0]||(e[0]=o=>s.pageNumber=o),total:s.totalRecords,pageSize:s.pageSize,"show-total":(o,w)=>`${w[0]}-${w[1]} of ${o} items`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination"},null,8,["current","total","pageSize","show-total"])]),t(O,{width:"750px",title:"Thay đổi vai trò trong hệ thống",open:c.value,"onUpdate:open":e[3]||(e[3]=o=>c.value=o),centered:""},{footer:a(()=>[t(A,{key:"Hủy",onClick:e[2]||(e[2]=o=>c.value=!1)},{default:a(()=>e[21]||(e[21]=[i("Hủy")])),_:1}),t(A,{key:"Xác nhận",type:"primary",onClick:H},{default:a(()=>e[22]||(e[22]=[i(" Xác nhận ")])),_:1})]),default:a(()=>[t(p,null,{default:a(()=>[t(r,{span:24},{default:a(()=>[t(M,{message:"Thay đổi này có tác động đến quyền truy cập của người dùng này trong hệ thống.",banner:""})]),_:1})]),_:1}),t(p,null,{default:a(()=>[t(r,{span:12},{default:a(()=>[t(C,{orientation:"left","orientation-margin":"0px"},{default:a(()=>e[19]||(e[19]=[i("Hiện tại")])),_:1}),l("div",ue,[l("div",de,[l("img",{src:d.value.imageString},null,8,pe)]),l("div",me,[t(p,null,{default:a(()=>[t(r,{span:24},{default:a(()=>[l("span",_e,_(d.value.fullName),1)]),_:1}),t(j,{color:d.value.roleName==="Admin"?"#cd201f":"#3b5999"},{default:a(()=>[i(_(d.value.roleName?d.value.roleName:"chưa cấu hình"),1)]),_:1},8,["color"])]),_:1})])])]),_:1}),t(r,{span:11},{default:a(()=>[t(C,{orientation:"left","orientation-margin":"0px"},{default:a(()=>e[20]||(e[20]=[i("Thay đổi")])),_:1}),l("div",ce,[l("div",fe,[l("img",{src:d.value.imageString},null,8,ge)]),l("div",ve,[t(p,null,{default:a(()=>[t(r,{span:24},{default:a(()=>[l("span",be,_(d.value.fullName),1)]),_:1})]),_:1}),t(p,{style:{"min-width":"150px"}},{default:a(()=>[t(r,{span:24},{default:a(()=>[t(X,{ref_key:"formChangeRole",ref:k,model:h,rules:q},{default:a(()=>[t(E,{name:"roleId"},{default:a(()=>[t(P,{value:h.roleId,"onUpdate:value":e[1]||(e[1]=o=>h.roleId=o),placeholder:"Chọn vai trò"},{default:a(()=>[(y(!0),N(S,null,V(R.value,o=>(y(),ee(G,{value:o.roleId},{default:a(()=>[i(_(o.roleName),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})])])]),_:1})]),_:1})]),_:1},8,["open"])],64)}}},Ne=J(ye,[["__scopeId","data-v-42a3e374"]]);export{Ne as default};
